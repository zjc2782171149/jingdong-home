{"version":3,"sources":["webpack:///./src/effects/addressEffect.js","webpack:///./src/views/upsertAddress/UpsertAddress.vue?965b","webpack:///./src/views/upsertAddress/UpsertAddress.vue","webpack:///./src/views/upsertAddress/UpsertAddress.vue?fe12"],"names":["useCommonAddressEffect","store","useStore","getAddressList","forceUpdate","addressList","state","length","get","result","data","commit","class","handleBackClick","addressId","upsertAddress","placeholder","formData","city","department","houseNumber","name","phone","router","getAddressItem","errno","back","setup","route","params","id","render","__scopeId"],"mappings":"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","file":"js/upsertAddress.6b92b91f.js","sourcesContent":["import { useStore } from 'vuex'\nimport { get } from '../utils/request'\n\nconst useCommonAddressEffect = () => {\n  const store = useStore()\n\n  const getAddressList = async (forceUpdate) => {\n    const addressList = store.state.addressList;\n    if(forceUpdate || !addressList.length) {\n      const result = await get('/api/user/address')\n      if(result?.data?.length) {\n        store.commit('changeAddressList', result.data)\n      }\n    }\n  }\n\n  return { getAddressList }\n}\n\nexport default useCommonAddressEffect","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./UpsertAddress.vue?vue&type=style&index=0&id=46f86bf1&lang=scss&scoped=true\"","<template>\n  <div class=\"wrapper\">\n    <div class=\"title\">\n      <div\n        class=\"iconfont title__back\"\n        @click=\"handleBackClick\"\n      >&#xe6f2;</div>\n      <div class=\"title__text\">\n        {{addressId ? '编辑收货地址': '新建收货地址'}}\n      </div>\n      <div class=\"title__save\" @click=\"upsertAddress\">保存</div>\n    </div>\n    <div class=\"form\">\n      <div class=\"form__item\">\n        <div class=\"form__item__label\">所在城市:</div>\n        <input class=\"form__item__content\" placeholder=\"如北京市\" v-model=\"formData.city\" />\n      </div>\n      <div class=\"form__item\">\n        <div class=\"form__item__label\">小区/大厦/学校:</div>\n        <input class=\"form__item__content\" placeholder=\"如理工大学国防科技园\" v-model=\"formData.department\" />\n      </div>\n      <div class=\"form__item\">\n        <div class=\"form__item__label\">楼号-门牌号:</div>\n        <input class=\"form__item__content\" placeholder=\"A号楼B层\" v-model=\"formData.houseNumber\" />\n      </div>\n      <div class=\"form__item\">\n        <div class=\"form__item__label\">收货人:</div>\n        <input class=\"form__item__content\" placeholder=\"请填写收货人的姓名\" v-model=\"formData.name\" />\n      </div>\n      <div class=\"form__item\">\n        <div class=\"form__item__label\">联系电话:</div>\n        <input class=\"form__item__content\" placeholder=\"请填写收货手机号\" v-model=\"formData.phone\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { toRefs, reactive } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { post, get, patch } from '../../utils/request'\nimport useCommonAddressEffect from '../../effects/addressEffect'\n\nconst useAddressEffect = () => {\n  const store = useStore()\n  const { addressList } = toRefs(store.state)\n  const { getAddressList } = useCommonAddressEffect()\n  getAddressList()\n  return { addressList }\n}\n\nconst useFormEffect = (addressId) => {\n  const router = useRouter()\n  const formData = reactive({\n    city: '', department: '', houseNumber: '', name: '', phone: ''\n  })\n  const getAddressItem = async () => {\n    const result = await get(`/api/user/address/${addressId}`)\n    if(result?.errno === 0 && result?.data) {\n      const { city, department, houseNumber, name, phone } = result.data;\n      formData.city = city\n      formData.department = department\n      formData.houseNumber = houseNumber\n      formData.name = name\n      formData.phone = phone\n    }\n  }\n  const upsertAddress = async () => {\n    if(addressId) {\n      const result = await patch(`/api/user/address/${addressId}`, {\n        data: formData\n      })\n      if (result?.errno === 0) { router.back() } \n    }else {\n      const result = await post('/api/user/address', {\n        data: formData\n      })\n      if (result?.errno === 0) { router.back() } \n    }\n  }\n  if(addressId) { getAddressItem() }\n  return { formData, upsertAddress }\n}\n\nexport default {\n  name: 'MyAddressList',\n  setup() {\n    const router = useRouter()\n    const route = useRoute()\n    const addressId = route?.params?.id\n    const { addressList } = useAddressEffect()\n    const { formData, upsertAddress } = useFormEffect(addressId)\n    const handleBackClick = () => { router.back() }\n    return { addressId, addressList, formData, handleBackClick, upsertAddress }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../style/viriables.scss';\n.wrapper {\n  overflow-y: auto;\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  background: $dark-bgColor;\n}\n.title {\n  display: flex;\n  line-height: .44rem;\n  background: $bgColor;\n  font-size: .16rem;\n  color: $content-fontcolor;\n  text-align: center;\n  &__back {\n    width: .2rem;\n    margin-left: .18rem;\n    font-size: .2rem;\n    color: $search-fontColor;\n  }\n  &__text {\n    flex: 1;\n    text-align: center;\n  }\n  &__save {\n    margin-right: .2rem;\n    font-size: .14rem;\n  }\n}\n.form {\n  padding: 0 .2rem;\n  margin-top: .12rem;\n  background: $bgColor;\n  border-top: .01rem solid $content-bgColor;\n  border-bottom: .01rem solid $content-bgColor;\n  &__item {\n    display: flex;\n    padding: .12rem 0;\n    line-height: .2rem;\n    font-size: .14rem;\n    border-bottom: .01rem solid $content-bgColor;\n    &:last-of-type {\n      border-bottom: none;\n    }\n    &__label {\n      margin-right: .05rem;\n      color: $medium-fontColor;\n    }\n    &__content {\n      flex: 1;\n      border: none;\n      outline: none;\n      color: #3F3F3F;\n      &::placeholder {\n        color: #3F3F3F;\n      }\n    }\n  }\n}\n</style>","import { render } from \"./UpsertAddress.vue?vue&type=template&id=46f86bf1&scoped=true\"\nimport script from \"./UpsertAddress.vue?vue&type=script&lang=js\"\nexport * from \"./UpsertAddress.vue?vue&type=script&lang=js\"\n\nimport \"./UpsertAddress.vue?vue&type=style&index=0&id=46f86bf1&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-46f86bf1\"\n\nexport default script"],"sourceRoot":""}